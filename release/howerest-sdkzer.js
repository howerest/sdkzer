/*! howerest-sdkzer 0.1.1 | howerest 2016 - <davidvalin@howerest.com> | Apache 2.0 Licensed */
var Util;!function(a){var b=function(){function a(){}return a.isBrowser=function(){return"undefined"!=typeof window},a.isNode=function(){return"undefined"!=typeof process&&"undefined"!=typeof process.env&&"undefined"!=typeof global},a.nodeVersion=function(){},a}();a.EnvChecker=b;var c=function(){function a(){}return a.obj=function(a){var b=this;return function(a){if(null===a||"object"!=typeof a)return function(a){return a}(a);var c=a.constructor();for(var d in a)a.hasOwnProperty(d)&&(a[d]instanceof Object?c[d]=b.obj(a[d]):c[d]=a[d]);return c}(a)},a}();a.Cloner=c;var d=function(){function a(){}return a.camelize=function(a){return this.walk(a)},a.walk=function(a){var b=this;return this.reduce(Object.keys(a),function(c,d){var e=b.camelCase(d);return c[e]=b.walk(a[d]),c},{})},a.camelCase=function(a){return a.replace(/[_.-](\w|$)/g,function(a,b){return b.toUpperCase()})},a.reduce=function(a,b,c){if(a.reduce)return a.reduce(b,c);for(var d=0;d<a.length;d++)c=b(c,a[d],d);return c},a.map=function(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c},a}();a.Camel=d}(Util||(Util={}));var WebServices;!function(a){var b=function(){function a(){try{return new XMLHttpRequest}catch(a){}try{return new ActiveXObject("Msxml3.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}return null}return a}();a.XHR=b;var c=function(){function a(a){this.name=Object.keys(a)[0],this.value=a[Object.keys(a)[0]]}return a}();a.HttpHeader=c;var d=function(){function a(a){this.response=null,this.query=a;var c,d=this,f=null;if(Util.EnvChecker.isBrowser())this.client=new b;else{if(!Util.EnvChecker.isNode())return;var g=require("xhr2");this.client=new g}this.client.open(this.query.httpMethod,this.query.endpoint);for(var h=0;h<this.query.headers.length;h++)this.client.setRequestHeader(this.query.headers[h].name,this.query.headers[h].value);this.query.headers.Accept||this.client.setRequestHeader("Accept","application/json"),this.query.headers["Content-Type"]||this.client.setRequestHeader("Content-Type","application/json;charset=UTF-8"),this.promise=new Promise(function(a,b){d.client.onreadystatechange=function(b){b&&4==b.target.readyState&&(200==b.target.status||204==b.target.status?(d.response=new e(d.query.endpoint,{},b.target.responseText?b.target.responseText:null),a(d.response)):(d.promise=Promise.reject(!1),a({})))}}),"object"==typeof this.query.data&&(c=Object.keys(this.query.data),c.length>0&&(f=JSON.stringify(this.query.data))),this.client.send(f)}return a}();a.HttpRequest=d;var e=function(){function a(a,b,c,d){if(void 0===d&&(d=!0),c&&d)try{this.data=JSON.parse(c)}catch(e){}else this.data=c}return a}();a.HttpResponse=e;var f=function(){function a(a){this.httpMethod="GET",this.qsParams={},this.headers=[],this.data={},this.endpoint=a.endpoint,this.httpMethod=a.httpMethod,this.qsParams=a.qsParams,this.headers=a.headers,this.data=a.data}return a.prototype.where=function(a){void 0===a&&(a=this.qsParams);for(var b in a)a.hasOwnProperty(b)&&(this.qsParams[b]=a[b]);return this},a.prototype.withHeaders=function(a){void 0===a&&(a=[]),this.headers=a},a.prototype.withData=function(a){void 0===a&&(a={}),this.data=a},a.prototype.qsParamsToString=function(a){return void 0===a&&(a=this.qsParams),this.serialize(a)},a.prototype.serialize=function(a){var b=[];for(var c in a){var d=a[c];b.push("object"==typeof d?this.serialize(d):encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")},a}();a.HttpQuery=f;var g=function(){function b(){}return b.mergeHttpQueries=function(b){for(var c=new a.HttpQuery({endpoint:null,httpMethod:null,qsParams:{},headers:[],data:{}}),d=0;d<b.length;d++)for(var e=["httpMethod","endpoint","headers","qsParams","data"],f=0;f<e.length;f++)null!==b[d][e[f]]&&(c[e[f]]=b[d][e[f]]);return c},b}();a.Merger=g}(WebServices||(WebServices={}));var Modularizer=function(){function a(){}return a.defineModule=function(a,b){if("undefined"!=typeof angular&&"undefined"!=typeof angular.module)angular.module(a,[]).factory([function(){return b}]);else{var c="undefined"!=typeof window,d="undefined"!=typeof process&&"undefined"!=typeof process.env&&"undefined"!=typeof global;c?"function"==typeof define&&define.amd||"undefined"!=typeof window&&(window[a]=b):d&&(global[a]=b)}},a}(),Sdkzer=function(){function Sdkzer(a){void 0===a&&(a={}),this.syncing=!1,this.lastResponse=null,this.attrs={id:null},this.pAttrs={id:null},this.setDefaults();for(var b in a)this.attrs[b]=a[b],this.pAttrs[b]=a[b]}return Sdkzer.configure=function(a){if(a.defaultHttpHeaders){Sdkzer.DEFAULT_HTTP_HEADERS=[];for(var b=0;b<a.defaultHttpHeaders.length;b++)Sdkzer.DEFAULT_HTTP_HEADERS.push(new WebServices.HttpHeader(a.defaultHttpHeaders[b]))}Sdkzer.HTTP_PATTERN=a.httpPattern?a.httpPattern:this.HTTP_PATTERN,Sdkzer.PARENTS_FETCH_STRATEGY=a.parentsFetchStrategy?a.parentsFetchStrategy:this.PARENTS_FETCH_STRATEGY,Sdkzer.HTTP_QUERY_GUESS_CONFIG=a.httpQueryGuessConfig?a.httpQueryGuessConfig:this.HTTP_QUERY_GUESS_CONFIG},Sdkzer.usingRestfulCrudHttpPattern=function(){return"restful_crud"===Sdkzer.HTTP_PATTERN},Sdkzer.usingCustomHttpPattern=function(){return"restful_crud"!==Sdkzer.HTTP_PATTERN},Sdkzer.usingParentsFetchStrategy=function(){return"none"!==Sdkzer.PARENTS_FETCH_STRATEGY},Sdkzer.getHttpQueryGuessConfigFor=function(a){return Sdkzer.usingRestfulCrudHttpPattern()?Sdkzer.HTTP_QUERY_GUESS_CONFIG.restful_crud:Sdkzer.HTTP_QUERY_GUESS_CONFIG.custom},Sdkzer.prototype.setDefaults=function(){if(this.defaults()){var a=this.defaults();for(var b in a)this.attrs[b]=a[b]}},Sdkzer.prototype.defaults=function(){return{}},Sdkzer.prototype.attr=function(attrName,value){if(void 0===attrName||void 0===value){if(void 0!==attrName&&void 0===value){for(var attrKeys=attrName.split("."),attrValue=this.attrs[attrName.split(".")[0]],i=1;i<attrKeys.length;i++)attrValue=attrValue[attrKeys[i]];return attrValue}return this.attrs}var attrKeys=attrName.split("."),attrKeyName="";eval("this.attrs['"+attrKeys.join("']['")+"'] = "+("string"==typeof value?"'"+value+"'":value))},Sdkzer.prototype.baseEndpoint=function(){return null},Sdkzer.prototype.resourceEndpoint=function(){return""},Sdkzer.prototype.isNew=function(){return null===this.attrs.id||null===this.lastResponse},Sdkzer.prototype.hasChanged=function(){return this.changedAttrs().length>0},Sdkzer.prototype.hasAttrChanged=function(a){var b,c=this.changedAttrs();for(b=0;b<c.length;b++)if(c[b]===a)return!0;return!1},Sdkzer.prototype.changedAttrs=function(){var a,b,c=[],d=Object.keys(this.attrs),e=Object.keys(this.pAttrs);for(a=0;a<=d.length;a++)for(b=0;b<=e.length;b++)if(null!==d[a]&&d[a]===e[b]&&this.attrs[d[a]]!==this.pAttrs[e[b]]){c.push(d[a]);break}return c},Sdkzer.prototype.prevAttrs=function(){var a={};for(var b in this.attrs)this.pAttrs[b]!==this.attrs[b]&&(a[b]=this.pAttrs[b]?this.pAttrs[b]:null);return a},Sdkzer.prototype.prevValue=function(a){return this.prevAttrs()[a]},Sdkzer.prototype.fetch=function(a,b){void 0===b&&(b=!0);var c,d=this;if(this.attrs.id){this.syncing=!0;var e=new WebServices.HttpQuery({httpMethod:"GET",endpoint:this.baseEndpoint()+"/"+this.attrs.id,headers:Sdkzer.DEFAULT_HTTP_HEADERS?Sdkzer.DEFAULT_HTTP_HEADERS:[],qsParams:{},data:{}});"undefined"!=typeof a&&(e=WebServices.Merger.mergeHttpQueries([e,a]));var f=new WebServices.HttpRequest(e);c=f.promise,c.then(function(a){d.syncing=!1;var b=d.$parse(a.data);d.pAttrs=b,d.attrs=b},function(a){d.syncing=!1})}return"undefined"==typeof c&&(c=Promise.reject(!1)),c},Sdkzer.prototype.$parse=function(a,b){return null!==b&&a[b]?a[b]:a},Sdkzer.prototype.toOriginJSON=function(){return this.attrs},Sdkzer.prototype.toOriginXML=function(){return""},Sdkzer.prototype.toOrigin=function(a){switch(a){case"json":this.toOriginJSON();break;case"xml":this.toOriginXML()}return this.attrs},Sdkzer.prototype.update=function(a){void 0===a&&(a=[]);var b,c,d=this;return"restful-crud"===Sdkzer.HTTP_PATTERN,b=new WebServices.HttpQuery({httpMethod:"PUT",endpoint:this.baseEndpoint()+"/"+this.attrs.id,headers:Sdkzer.DEFAULT_HTTP_HEADERS?Sdkzer.DEFAULT_HTTP_HEADERS:[],qsParams:{},data:this.toOriginJSON()}),c=new WebServices.HttpRequest(b),c.promise.then(function(a){d.lastResponse=a})},Sdkzer.prototype.destroy=function(){var a,b;return a=new WebServices.HttpQuery({httpMethod:"DELETE",endpoint:this.baseEndpoint()+"/"+this.attrs.id,headers:Sdkzer.DEFAULT_HTTP_HEADERS?Sdkzer.DEFAULT_HTTP_HEADERS:[],qsParams:{},data:{}}),b=new WebServices.HttpRequest(a),b.promise},Sdkzer.fetchIndex=function(a){var b,c,d,e,f=this,g=[];return d=new Promise(function(d,h){b=new WebServices.HttpQuery({httpMethod:"GET",endpoint:(new f).baseEndpoint(),headers:Sdkzer.DEFAULT_HTTP_HEADERS?Sdkzer.DEFAULT_HTTP_HEADERS:[],qsParams:{},data:{}}),"undefined"!=typeof a&&(b=WebServices.Merger.mergeHttpQueries([b,a])),c=new WebServices.HttpRequest(b),c.promise.then(function(a){for(var b in a.data)e=new f,e.attrs=e.pAttrs=e.$parse(a.data[b]),g.push(e);d(g)},function(a){h(a)})})},Sdkzer.fetchOne=function(a,b){var c,d,e,f,g=this,h=new this;return e=new Promise(function(e,i){c=new WebServices.HttpQuery({httpMethod:"GET",endpoint:h.baseEndpoint()+"/"+a,headers:Sdkzer.DEFAULT_HTTP_HEADERS?Sdkzer.DEFAULT_HTTP_HEADERS:[],qsParams:{},data:{}}),"undefined"!=typeof b&&(c=WebServices.Merger.mergeHttpQueries([c,b])),d=new WebServices.HttpRequest(c),d.promise.then(function(a){f=new g,f.attrs=f.pAttrs=f.$parse(a.data),e(f)},function(a){i(a)})})},Sdkzer.DEFAULT_HTTP_HEADERS=[],Sdkzer.HTTP_PATTERN="restful_crud",Sdkzer.PARENTS_FETCH_STRATEGY="none",Sdkzer.HTTP_QUERY_GUESS_CONFIG={restful_crud:{read_collection:{verb:"GET",endpoint:""},read_record:{verb:"GET",endpoint:""},create_record:{verb:"GET",endpoint:""},update_record:{verb:"GET",endpoint:""},delete_record:{verb:"GET",endpoint:""}}},Sdkzer}();Modularizer.defineModule("Sdkzer",Sdkzer);