/*! howerest-sdkzer 0.0.22 | howerest 2016 - <davidvalin@howerest.com> | Apache 2.0 Licensed */
var Util;!function(a){var b=function(){function a(){}return a.isBrowser=function(){return"undefined"!=typeof window},a.isNode=function(){return"undefined"!=typeof process&&"undefined"!=typeof process.env&&"undefined"!=typeof global?!0:!1},a.nodeVersion=function(){},a}();a.EnvChecker=b;var c=function(){function a(){}return a.obj=function(a){var b=this;return function(a){if(null===a||"object"!=typeof a)return function(a){return a}(a);var c=a.constructor();for(var d in a)a.hasOwnProperty(d)&&(a[d]instanceof Object?c[d]=b.obj(a[d]):c[d]=a[d]);return c}(a)},a}();a.Cloner=c;var d=function(){function a(){}return a.camelize=function(a){return this.walk(a)},a.walk=function(a){var b=this;return this.reduce(Object.keys(a),function(c,d){var e=b.camelCase(d);return c[e]=b.walk(a[d]),c},{})},a.camelCase=function(a){return a.replace(/[_.-](\w|$)/g,function(a,b){return b.toUpperCase()})},a.reduce=function(a,b,c){if(a.reduce)return a.reduce(b,c);for(var d=0;d<a.length;d++)c=b(c,a[d],d);return c},a.map=function(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c},a}();a.Camel=d}(Util||(Util={}));var WebServices;!function(a){var b=function(){function a(){try{return new XMLHttpRequest}catch(a){}try{return new ActiveXObject("Msxml3.XMLHTTP")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}return null}return a}();a.XHR=b;var c=function(){function a(a){this.name=Object.keys(a)[0],this.value=a[Object.keys(a)[0]]}return a}();a.HttpHeader=c;var d=function(){function a(a){this.response=null,this.query=a;var c=this;if(Util.EnvChecker.isBrowser())this.client=new b;else{if(!Util.EnvChecker.isNode())return;var d=require("xhr2");this.client=new d}this.client.open(this.query.httpMethod,this.query.endpoint);for(var f in this.query.headers)this.client.setRequestHeader(f,this.query.headers[f]);this.client.setRequestHeader("Accept","application/json"),this.promise=new Promise(function(a,b){this.client.onreadystatechange=function(b){b&&4==b.target.readyState?200==b.target.status&&(c.response=new e(this.endpoint,{},b.target.responseText),a(c.response)):(c.promise=Promise.reject(!1),a({}))}}),this.client.send(this.query.data?JSON.stringify(this.query.data):null)}return a}();a.HttpRequest=d;var e=function(){function a(a,b,c,d){void 0===d&&(d=!0),this.data=Object.keys(c).length>0?JSON.parse(c):{}}return a}();a.HttpResponse=e;var f=function(){function a(a){this.httpMethod="GET",this.qsParams={},this.headers=[],this.data={},this.endpoint=a.endpoint,this.httpMethod=a.httpMethod,this.qsParams=a.qsParams,this.headers=a.headers,this.data=a.data}return a.prototype.where=function(a){void 0===a&&(a=this.qsParams);for(var b in a)a.hasOwnProperty(b)&&(this.qsParams[b]=a[b]);return this},a.prototype.withHeaders=function(a){void 0===a&&(a=[]),this.headers=a},a.prototype.withData=function(a){void 0===a&&(a={}),this.data=a},a.prototype.qsParamsToString=function(a){return void 0===a&&(a=this.qsParams),this.serialize(a)},a.prototype.serialize=function(a){var b=[];for(var c in a){var d=a[c];b.push("object"==typeof d?this.serialize(d):encodeURIComponent(c)+"="+encodeURIComponent(d))}return b.join("&")},a}();a.HttpQuery=f}(WebServices||(WebServices={}));var Modularizer=function(){function a(){}return a.defineModule=function(a,b){if("undefined"!=typeof angular&&"undefined"!=typeof angular.module)angular.module(a,[]).factory([function(){return b}]);else{var c="undefined"!=typeof window,d="undefined"!=typeof process&&"undefined"!=typeof process.env&&"undefined"!=typeof global?!0:!1;c?"function"==typeof define&&define.amd||"undefined"!=typeof window&&(window[a]=b):d&&(global[a]=b)}},a}(),Sdkzer=function(){function a(a){void 0===a&&(a={}),this.syncing=!1,this.lastResponse=null,this.attrs={id:null},this.pAttrs={id:null},this.setDefaults();for(var b in a)this.attrs[b]=a[b],this.pAttrs[b]=a[b]}return a.configure=function(b){if(b.defaultHttpHeaders){a.DEFAULT_HTTP_HEADERS=[];for(var c=0;c<b.defaultHttpHeaders.length;c++)a.DEFAULT_HTTP_HEADERS.push(new WebServices.HttpHeader(b.defaultHttpHeaders[c]))}a.HTTP_PATTERN=b.httpPattern?b.httpPattern:this.HTTP_PATTERN,a.PARENTS_FETCH_STRATEGY=b.parentsFetchStrategy?b.parentsFetchStrategy:this.PARENTS_FETCH_STRATEGY,a.HTTP_QUERY_GUESS_CONFIG=b.httpQueryGuessConfig?b.httpQueryGuessConfig:this.HTTP_QUERY_GUESS_CONFIG},a.usingRestfulCrudHttpPattern=function(){return"restful_crud"===a.HTTP_PATTERN?!0:!1},a.usingCustomHttpPattern=function(){return"restful_crud"!==a.HTTP_PATTERN?!0:!1},a.usingParentsFetchStrategy=function(){return"none"!==a.PARENTS_FETCH_STRATEGY?!0:!1},a.getHttpQueryGuessConfigFor=function(b){return a.usingRestfulCrudHttpPattern()?a.HTTP_QUERY_GUESS_CONFIG.restful_crud:a.HTTP_QUERY_GUESS_CONFIG.custom},a.prototype.setDefaults=function(){if(this.defaults()){var a=this.defaults();for(var b in a)this.attrs[b]=a[b]}},a.prototype.defaults=function(){return{}},a.prototype.attr=function(a,b){return void 0===a||void 0===b?void 0!==a&&void 0===b?this.attrs[a]:this.attrs:void(this.attrs[a]=b)},a.prototype.resourceEndpoint=function(){return""},a.prototype.isNew=function(){return null!==this.attrs.id?!1:!0},a.prototype.hasChanged=function(){return this.changedAttrs().length>0?!0:!1},a.prototype.hasAttrChanged=function(a){var b,c=this.changedAttrs();for(b=0;b<c.length;b++)if(c[b]===a)return!0;return!1},a.prototype.changedAttrs=function(){var a,b,c=[],d=Object.keys(this.attrs),e=Object.keys(this.pAttrs);for(a=0;a<=d.length;a++)for(b=0;b<=e.length;b++)if(null!==d[a]&&d[a]===e[b]&&this.attrs[d[a]]!==this.pAttrs[e[b]]){c.push(d[a]);break}return c},a.prototype.prevAttrs=function(){var a={};for(var b in this.attrs)this.pAttrs[b]!==this.attrs[b]&&(a[b]=this.pAttrs[b]?this.pAttrs[b]:null);return a},a.prototype.previousValue=function(a){},a.prototype.fetch=function(a,b,c){void 0===b&&(b=!0),void 0===c&&(c=[]);var d,e=this;if(this.attrs.id){this.syncing=!0;var f=new WebServices.HttpQuery({httpMethod:"GET",endpoint:this.resourceEndpoint()+"/"+this.attrs.id,qsParams:{},headers:[],data:{}}),g=new WebServices.HttpRequest(f);d=g.promise,d.then(function(a){e.syncing=!1;var b=e.parse(a.data);for(var c in b)e.attrs[c]!=b[c]&&(e.pAttrs[c]=b[c]);e.attrs=b},function(a){e.syncing=!1})}return"undefined"==typeof d&&(d=new Promise(function(a,b){}),d=Promise.reject(!1)),d},a.prototype.parse=function(a){return a},a.prototype.toOriginJSON=function(){return this.attrs},a.prototype.toOriginXML=function(){},a.prototype.toOrigin=function(a){switch(a){case"json":this.toOriginJSON();break;case"xml":this.toOriginXML()}return this.attrs},a.prototype.update=function(b){void 0===b&&(b=[]);var c,d,e=this;return"restful-crud"===a.HTTP_PATTERN,this.hasChanged()?(c=new WebServices.HttpQuery({httpMethod:"PUT",endpoint:this.resourceEndpoint()+"/"+this.attrs.id,headers:[],qsParams:{},data:{}}),d=new WebServices.HttpRequest(c),d.promise.then(function(a){e.lastResponse=a})):void 0},a.prototype.destroy=function(){var a,b;a=new WebServices.HttpQuery({httpMethod:"DELETE",endpoint:this.resourceEndpoint()+"/"+this.attrs.id,qsParams:{},headers:[],data:{}}),b=new WebServices.HttpRequest(a)},a.fetchIndex=function(a){var b,c;return b=new WebServices.HttpQuery({httpMethod:"GET",endpoint:(new this).resourceEndpoint(),headers:[],qsParams:{},data:{}}),c=new WebServices.HttpRequest(b),c.promise},a.fetchOne=function(a,b){var c,d,e=new this;return c="undefined"==typeof b?new WebServices.HttpQuery({httpMethod:"GET",endpoint:e.resourceEndpoint()+"/"+a,qsParams:{},headers:[],data:{}}):b,d=new WebServices.HttpRequest(c),d.promise},a.DEFAULT_HTTP_HEADERS=[],a.HTTP_PATTERN="restful_crud",a.PARENTS_FETCH_STRATEGY="none",a.HTTP_QUERY_GUESS_CONFIG={restful_crud:{read_collection:{verb:"GET",endpoint:""},read_record:{verb:"GET",endpoint:""},create_record:{verb:"GET",endpoint:""},update_record:{verb:"GET",endpoint:""},delete_record:{verb:"GET",endpoint:""}}},a}();Modularizer.defineModule("Sdkzer",Sdkzer);